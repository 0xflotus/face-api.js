{"version":3,"sources":["webpack:///./src/components/FaceSimilarity.tsx","webpack:///./src/pages/bbt_face_similarity.tsx","webpack:///./node_modules/gatsby/node_modules/core-js/modules/_flags.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.regexp.to-string.js","webpack:///./node_modules/gatsby/node_modules/core-js/modules/es6.regexp.flags.js","webpack:///./src/components/ModalLoader.tsx","webpack:///./src/components/ImageSelection.tsx","webpack:///./src/components/SelectableImage.tsx","webpack:///./src/styled/MarginTop.tsx"],"names":["FaceSimilarity","props","text","backgroundColor","isMatch","state","render","window","document","ALIGNED_FACE_IMAGES","url","inputImg1","img","setState","maxWidth","inputImg2","MODELS_URI","faceDescriptors","distance","faceapi","React","ModalLoader","title","ImageSelection","items","selectedImage","onChange","e","target","value","map","item","label","Container","styled","div","Margin","SelectionTypes","SelectableImage","imageSrc","initialImageSrc","onChangeSelection","bind","onLoadFromDisk","file","files","reader","FileReader","onload","loadEvent","result","readAsDataURL","selectionType","imageStyle","SELECT","BOTH","FILE","imgId","display","defaultProps","MarginTop"],"mappings":"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","file":"component---src-pages-bbt-face-similarity-tsx-9676a6acc9e88922a056.js","sourcesContent":["import { FormControl, Input, InputLabel } from '@material-ui/core';\nimport * as React from 'react';\n\nexport type FaceSimilarityProps = {\n  text: string\n  isMatch: boolean\n}\n\nexport const FaceSimilarity = (props: FaceSimilarityProps) =>\n  <FormControl>\n    <InputLabel htmlFor=\"distance\">\n      Distance:\n    </InputLabel>\n    <Input\n      id=\"distance\"\n      value={props.text}\n      style={{ backgroundColor: props.isMatch ? '#b2ff59' : '#ea605d' }}\n    />\n  </FormControl>\n","import * as faceapi from 'face-api.js';\nimport { ComputeFaceDescriptors, LoadModels, MediaElement } from 'face-api.js-react';\nimport * as React from 'react';\n\nimport { FaceSimilarity } from '../components/FaceSimilarity';\nimport { ModalLoader } from '../components/ModalLoader';\nimport { SelectableImage } from '../components/SelectableImage';\nimport { ALIGNED_FACE_IMAGES, MODELS_URI } from '../const';\nimport { Root } from '../Root';\nimport { MarginTop } from '../styled/MarginTop';\nimport { SideBySide } from '../styled/SideBySide';\n\ntype PageState = {\n  inputImg1?: MediaElement\n  inputImg2?: MediaElement\n}\n\nexport default class extends React.Component<{}, PageState> {\n\n  state: PageState = {\n  }\n\n  public render() {\n    if (!(typeof window !== 'undefined' && window.document) ){\n      return null\n    }\n\n    return(\n      <Root>\n        <SideBySide>\n          <SelectableImage\n            items={ALIGNED_FACE_IMAGES}\n            initialImageSrc={ALIGNED_FACE_IMAGES[30].url}\n            onLoaded={({ img: inputImg1 }) => this.setState({ inputImg1 })}\n            imageStyle={{ maxWidth: 150 }}\n            imgId=\"img1\"\n          />\n          <SelectableImage\n            items={ALIGNED_FACE_IMAGES}\n            initialImageSrc={ALIGNED_FACE_IMAGES[31].url}\n            onLoaded={({ img: inputImg2 }) => this.setState({ inputImg2 })}\n            imageStyle={{ maxWidth: 150 }}\n            imgId=\"img2\"\n          />\n        </SideBySide>\n        <MarginTop>\n          <LoadModels\n            faceRecognitionModelUrl={MODELS_URI}\n            renderBusyComponent={\n              () => <ModalLoader title=\"Loading Face Recognition Model\" />\n            }\n          >\n          {() =>\n            <ComputeFaceDescriptors\n              inputs={[this.state.inputImg1, this.state.inputImg2]}\n              renderBusyComponent={\n                () => <ModalLoader title=\"Computing Face Descriptors\" />\n              }\n            >\n            {({ faceDescriptors }) => {\n              if (!faceDescriptors) {\n                return null\n              }\n\n              const distance = faceapi.euclideanDistance(\n                faceDescriptors[0],\n                faceDescriptors[1]\n              )\n              return (\n                <FaceSimilarity\n                  text={`${faceapi.round(distance)}`}\n                  isMatch={distance < 0.6}\n                />\n              )\n            }}\n            </ComputeFaceDescriptors>\n          }\n          </LoadModels>\n        </MarginTop>\n      </Root>\n    )\n  }\n}","'use strict';\n// 21.2.5.3 get RegExp.prototype.flags\nvar anObject = require('./_an-object');\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","'use strict';\nrequire('./es6.regexp.flags');\nvar anObject = require('./_an-object');\nvar $flags = require('./_flags');\nvar DESCRIPTORS = require('./_descriptors');\nvar TO_STRING = 'toString';\nvar $toString = /./[TO_STRING];\n\nvar define = function (fn) {\n  require('./_redefine')(RegExp.prototype, TO_STRING, fn, true);\n};\n\n// 21.2.5.14 RegExp.prototype.toString()\nif (require('./_fails')(function () { return $toString.call({ source: 'a', flags: 'b' }) != '/a/b'; })) {\n  define(function toString() {\n    var R = anObject(this);\n    return '/'.concat(R.source, '/',\n      'flags' in R ? R.flags : !DESCRIPTORS && R instanceof RegExp ? $flags.call(R) : undefined);\n  });\n// FF44- RegExp#toString has a wrong name\n} else if ($toString.name != TO_STRING) {\n  define(function toString() {\n    return $toString.call(this);\n  });\n}\n","// 21.2.5.3 get RegExp.prototype.flags()\nif (require('./_descriptors') && /./g.flags != 'g') require('./_object-dp').f(RegExp.prototype, 'flags', {\n  configurable: true,\n  get: require('./_flags')\n});\n","import { Dialog, DialogContent, DialogTitle, LinearProgress } from '@material-ui/core';\nimport * as React from 'react';\n\nexport interface ModalLoaderProps {\n  title: string\n}\n\nexport const ModalLoader = (props: ModalLoaderProps) =>         \n  <Dialog\n    disableBackdropClick\n    disableEscapeKeyDown\n    open={true}\n  >\n    <DialogTitle>\n      { props.title }\n    </DialogTitle>\n    <DialogContent>\n      <LinearProgress />\n    </DialogContent>\n  </Dialog>","import { FormControl, FormHelperText, Input, MenuItem, Select } from '@material-ui/core';\nimport * as React from 'react';\n\nexport type ImageSelectionItem = {\n  url: string\n  label: string\n}\n\ntype ImageSelectionProps = {\n  items: ImageSelectionItem[]\n  selectedImage: string\n  onChange: (value: string) => void\n}\n\nexport const ImageSelection = ({ items, selectedImage, onChange }: ImageSelectionProps) =>\n  <FormControl>\n    <Select\n      value={selectedImage}\n      onChange={e => onChange(e.target.value)}\n      input={<Input />}\n    >\n      {\n        items.map(item =>\n          <MenuItem\n            key={item.url}\n            value={item.url}\n          >\n            { item.label }\n          </MenuItem>\n        )\n      }\n    </Select>\n    <FormHelperText>Pick an image</FormHelperText>\n  </FormControl>","import * as Mui from '@material-ui/core';\nimport { MediaElement } from 'face-api.js-react';\nimport * as React from 'react';\nimport styled from 'styled-components';\n\nimport { ImageWithOverlay } from '../../face-api.js-react';\nimport { SideBySide } from '../styled/SideBySide';\nimport { ImageSelection, ImageSelectionItem } from './ImageSelection';\n\nconst Container = styled.div`\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`\n\nconst Margin = styled.div`\n  margin: 10px;\n`\n\n\nexport enum SelectionTypes {\n  SELECT = 'SELECT',\n  FILE = 'FILE',\n  BOTH = 'BOTH'\n}\n\nexport type SelectableImageProps = {\n  onLoaded: (refs: { img: MediaElement, overlay: HTMLCanvasElement}) => any\n  imgId: string\n  items?: ImageSelectionItem[]\n  initialImageSrc?: string\n  selectionType?: SelectionTypes\n  imageStyle?: React.CSSProperties\n}\n\nexport type SelectableImageState = {\n  imageSrc: string\n}\n\nexport class SelectableImage extends React.Component<SelectableImageProps, SelectableImageState> {\n  static defaultProps: Partial<SelectableImageProps> = {\n    selectionType: SelectionTypes.SELECT\n  }\n\n  constructor(props: SelectableImageProps) {\n    super(props)\n\n    this.state = {\n      imageSrc: props.initialImageSrc\n    }\n\n    this.onChangeSelection = this.onChangeSelection.bind(this)\n    this.onLoadFromDisk = this.onLoadFromDisk.bind(this)\n  }\n\n  onChangeSelection(imageSrc: string) {\n    this.setState({\n      imageSrc\n    })\n  }\n\n  onLoadFromDisk(e: any) {\n    const file = (e.target.files || [])[0]\n    if (!file) {\n      return\n    }\n\n    const reader = new FileReader()\n\n    reader.onload = (loadEvent: any) =>\n    this.setState({\n      imageSrc: loadEvent.target.result\n    })\n\n    reader.readAsDataURL(e.target.files[0])\n  }\n\n  render() {\n    const { selectionType } = this.props\n    return (\n      <Container>\n        <ImageWithOverlay\n          {...this.props}\n          imageSrc={this.state.imageSrc}\n          imageStyle={this.props.imageStyle}\n        />\n        <SideBySide>\n        {\n          (selectionType === SelectionTypes.SELECT || selectionType === SelectionTypes.BOTH)\n            &&\n            <Margin>\n              <ImageSelection\n                items={this.props.items}\n                selectedImage={this.state.imageSrc}\n                onChange={this.onChangeSelection}\n              />\n            </Margin>\n        }\n        {\n          (selectionType === SelectionTypes.FILE || selectionType === SelectionTypes.BOTH)\n            &&\n            <Margin>\n              <input\n                accept=\"image/*\"\n                id={this.props.imgId}\n                multiple\n                style={{ display: 'none' }}\n                onChange={this.onLoadFromDisk}\n                type=\"file\"\n              />\n              <label htmlFor={this.props.imgId}>\n                <Mui.Button variant=\"outlined\" component=\"span\">\n                  From Disk\n                </Mui.Button>\n              </label>\n            </Margin>\n        }\n        </SideBySide>\n      </Container>\n    )\n  }\n}","import styled from 'styled-components';\n\nexport const MarginTop = styled.div`\n  margin-top: 10px;\n`"],"sourceRoot":""}