{"version":3,"sources":["webpack:///./src/facc/DetectFaceLandmarks.tsx","webpack:///./src/pages/face_landmarks.tsx","webpack:///./src/styled/MarginTop.tsx?2673"],"names":[],"mappings":";;;;;;;;;;;;;;;;AACA,iCAcA;;KAAiC;;;AAAjC;;;;;AAEI,eAAK;AACU,4BAoCjB;AArCoC;;AAqCnC;;mCAjC0B;;;;AACvB,iBAAI,MAAW,MAAK,KAAM;AAAO,wBAAI,IAAU;cAAtC,GAAwC;AACzC;AACP;AAED,iBAAmB,gBAAG,cAAiB,SAC3B,MAAK,KAAI,IAAE;qBAAW;;AAC9B,wBAAW,OAAM,MAAgB,gBAAgB,gBACnD;AACD,cAHK,CAD6B;AAM/B,kBAAS;AAGf;AAHgB;AAGf;;;;;;;;;mCAEiB,iDAAoC;AACpD,aACM,KAAM,MAAgB,oBAAc,UAAgB,mBAC/C,KAAM,MAAK,SAAc,UAAK,QAC9B,KAAM,MAAS,aAAc,UAAS,UAC/C;AACI,kBAAsB;AAE9B;AAAC;;mCAEgB;AACX,cACN;AAAC;;mCAEK;AACJ,gBAAW,KAAM,MAAS,SAAK,KAAM,MACvC;AACD;;;GAvC2C,MAA8D;;AAA5G,+BAuCG,oB;;;;;;;;;;;;;;;;ACtDH,kCAA+D;AAC/D,mCAAuC;AACvC,yCAAyC;AACzC,iCAA+B;AAE/B,6CAAgE;AAChE,mCAA+C;AAC/C,iDAAkE;AAClE,wCAAgD;AAChD,uCAAyC;AACzC,kCAA+B;AAC/B,uCAQA;;KAAqB;;;AAArB;;;;;AAEE,eAAK;AACK,uBAAE,IAAI,YAAS,UAAC,QAAmB,oBAAI,IAAK;AAC3C,wBACV;AAH+B;AAKhC,eAAe,kBAAQ;AACjB,mBAAS;AAAU,wBAAC,EAAW,WAAE,CAAM,MAC7C;;AAyDF;;AAAC;;yBAvDc;;;AACX,aAAK,EAAC,OAAa,WAAgB,eAAU,OAAU,WAAE;AACvD,oBAAW;AACZ;AAEK,oCACH,OAAI,gCACF,kBAAe,mBACT,OAAE,QAAmB,qBACX,iBAAM,KAAM,MAAS,SAAS,UACrC;AAAG,qBAAe,gBAAV;qBAAyB;wBAAK,OAAS,SAAC,EAAU,oBAAY;gBACjE,eACb,KALF,GAMA,oBAAC,YAAS,iBACR,oBAAC,OAAgB,oBACR,SACL,oBAAC,OAAQ,YACA,SAAM,KAAM,MAAU,WACrB,UAAM,KAAgB,iBACzB,OACL,cAEC,OAEG,sCACX,aAAU,cAAqB,sBAAE,cAAU,WAAW;AAEpD,iBAAuB;wCACrB,sBAAmB,uBACd,MAAE,CAAK,OAAM,MAAU,WACZ,iBAAiB,mBAGhC,UAAkB;AACV,8BAA6B,OAAM;qBAA1B;qBAAa;;AAE5B,qBAAW,WAAiB;AACpB,yBAAO,QAAoB;yBAAV;;AAChB,6BAAW,WAAM,MAAU,UAAE,GAAG,GAAO,OAAS;AAChD,6BAAc,cACZ,uBACU;AAAK,gCAAE,EAAQ,QAAM,OAAU;sBAAnC,GACb,EACD;AACF;AAED,wBACF;AAOZ,cA1BU;UAHJ,CAnBF;AAiDL;;;GAlEiC,MAAsC;;AAAxE,mBAkEC,U;;;;;;;;;;;;;;ACrFD,+CAAuC;AAE1B,SAAS,YAAG,oBAAM,QAE9B,qB","file":"component---src-pages-face-landmarks-tsx-a667ef49d4f75acbefe7.js","sourcesContent":["import * as faceapi from 'face-api.js';\nimport * as React from 'react';\n\nimport { ImageWrap } from '../ImageWrap';\n\nexport interface DetectFaceLandmarksProps {\n  faceLandmarkNet: faceapi.FaceLandmarkNet\n  imgs: ImageWrap[]\n  children: (faceLandmarks: faceapi.FaceLandmarks68[] | null) => React.Component | JSX.Element\n}\n\nexport interface DetectFaceLandmarksState {\n  faceLandmarks: faceapi.FaceLandmarks68[] | null\n}\n\nexport class DetectFaceLandmarks extends React.Component<DetectFaceLandmarksProps, DetectFaceLandmarksState> {\n\n    state: DetectFaceLandmarksState = {\n      faceLandmarks: null\n    }\n\n    async detectFaceLandmarks() {\n      if (!this.props.imgs.every(img => img.isLoaded)) {\n        return\n      }\n\n      const faceLandmarks = await Promise.all(\n        this.props.imgs.map(({ img }) => {\n          return this.props.faceLandmarkNet.detectLandmarks(img) as Promise<faceapi.FaceLandmarks68>\n        })\n      )\n\n      this.setState({\n        faceLandmarks\n      })\n    }\n\n    componentDidUpdate(prevProps: DetectFaceLandmarksProps) {\n      if (\n        this.props.faceLandmarkNet !== prevProps.faceLandmarkNet\n          || this.props.imgs !== prevProps.imgs\n          || this.props.children !== prevProps.children\n      ) {\n        this.detectFaceLandmarks()\n      }\n    }\n\n    componentDidMount() {\n      this.detectFaceLandmarks()\n    }\n\n    render() {\n      return this.props.children(this.state.faceLandmarks)\n    }\n  }\n\n\n\n// WEBPACK FOOTER //\n// ./src/facc/DetectFaceLandmarks.tsx","import { Checkbox, FormControlLabel } from '@material-ui/core';\nimport * as faceapi from 'face-api.js';\nimport { withPrefix } from 'gatsby-link';\nimport * as React from 'react';\n\nimport { SelectableImage } from '../components/SelectableImage';\nimport { ALIGNED_FACE_IMAGES } from '../const';\nimport { DetectFaceLandmarks } from '../facc/DetectFaceLandmarks';\nimport { LoadModels } from '../facc/LoadModels';\nimport { ImageWrap } from '../ImageWrap';\nimport { Root } from '../Root';\nimport { MarginTop } from '../styled/MarginTop';\n\ntype FaceLandmarksPageState = {\n  inputImg: ImageWrap\n  drawLines: boolean\n  overlay?: HTMLCanvasElement\n}\n\nexport default class extends React.Component<{}, FaceLandmarksPageState> {\n\n  state: FaceLandmarksPageState = {\n    inputImg: new ImageWrap(ALIGNED_FACE_IMAGES[30].url),\n    drawLines: true\n  }\n\n  toggleDrawLines = () => {\n    this.setState(state => ({ drawLines: !state.drawLines }))\n  }\n\n  public render() {\n    if (!(typeof window !== 'undefined' && window.document) ){\n      return null\n    }\n\n    return(\n      <Root>\n        <SelectableImage\n          items={ALIGNED_FACE_IMAGES}\n          initialImageSrc={this.state.inputImg.imageSrc}\n          onLoaded={({ img: inputImg, overlay }) => this.setState({ inputImg, overlay })}\n          maxImageWidth={150}\n        />\n        <MarginTop>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={this.state.drawLines}\n                onChange={this.toggleDrawLines}\n                color=\"primary\"\n              />\n            }\n            label=\"Draw Lines\"\n          />\n        </MarginTop>\n        <LoadModels faceLandmarkModelUrl={withPrefix('/models')}>\n        {\n          ({ faceLandmarkNet }) =>\n            <DetectFaceLandmarks\n              imgs={[this.state.inputImg]}\n              faceLandmarkNet={faceLandmarkNet}\n            >\n            {\n              (faceLandmarks) => {\n                const { overlay, drawLines } = this.state\n\n                if (overlay && faceLandmarks) {\n                  const { width, height } = overlay\n                  overlay.getContext('2d').clearRect(0, 0, width, height)\n                  faceapi.drawLandmarks(\n                    overlay,\n                    faceLandmarks.map(l => l.forSize(width, height)),\n                    { drawLines }\n                  )\n                }\n\n                return null\n              }\n            }\n            </DetectFaceLandmarks>\n        }\n        </LoadModels>\n      </Root>\n    )\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/face_landmarks.tsx","import styled from 'styled-components';\r\n\r\nexport const MarginTop = styled.div`\r\n  margin-top: 10px;\r\n`\n\n\n// WEBPACK FOOTER //\n// ./src/styled/MarginTop.tsx"],"sourceRoot":""}