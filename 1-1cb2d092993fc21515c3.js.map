{"version":3,"sources":["webpack:///./src/components/styled/SideBySide.tsx","webpack:///./src/const.ts","webpack:///./src/components/InputTypeTabs.tsx","webpack:///./src/components/FaceDetectorSelection/const.ts","webpack:///./src/components/AdjustableInput.tsx","webpack:///./src/components/FaceDetectorSelection/MtcnnControls.tsx","webpack:///./src/components/FaceDetectorSelection/SsdMobilenetv1Controls.tsx","webpack:///./src/components/FaceDetectorSelection/TinyFaceDetectorControls.tsx","webpack:///./src/components/FaceDetectorSelection/FaceDetectorSelectionDialog.tsx","webpack:///./src/components/FaceDetectorSelection/index.tsx","webpack:///./src/MediaElement.ts","webpack:///./src/components/ImageWithOverlay.tsx","webpack:///./src/components/FileSelectionControls.tsx","webpack:///./src/components/SelectableInputElement.tsx","webpack:///./src/components/SelectableImage.tsx","webpack:///./src/components/styled/CenterContent.tsx","webpack:///./src/components/VideoWithOverlay.tsx","webpack:///./src/components/SelectableVideo.tsx","webpack:///./src/components/WebcamVideoWithOverlay.tsx","webpack:///./src/components/InputComponent.tsx","webpack:///./src/components/ModalLoader.tsx","webpack:///./src/components/styled/StyledLink.tsx","webpack:///./src/components/SideMenu.tsx","webpack:///./src/layouts/PageLayout.tsx","webpack:///./src/Root.tsx","webpack:///./src/container/BasePage.tsx","webpack:///util (ignored)","webpack:///util (ignored)?56b2","webpack:///buffer (ignored)","webpack:///crypto (ignored)","webpack:///./src/getPageContext.js"],"names":["SideBySide","styled","div","props","alignItems","DOCS_URI","withPrefix","EXAMPLE_IMAGES","map","idx","label","url","EXAMPLE_IMAGES_FACE_EXPRESSIONS","expression","ALIGNED_FACE_IMAGES_BY_CLASS","clazz","EXAMPLE_VIDEOS","MODELS_URI","ALIGNED_FACE_IMAGES","reduce","flat","arr","concat","TabComponent","InputType","InputTypeTabs","inputType","onChange","_","TINY_FACE_DETECTOR","SSD_MOBILENET_V1","MTCNN","FACE_DETECTORS","getFaceDetectorNameFromOptions","options","faceapi","Error","createDefaultFaceDetectorOptionsFromName","detectorName","getFaceDetectionNetFromName","ssdMobilenetv1","tinyFaceDetector","mtcnn","AdjustableInput","inputId","value","Math","max","step","minValue","min","maxValue","MtcnnControls","assignOptions","partial","detectionParams","scaleFactor","minFaceSize","onParamsChanged","SsdMobilenetv1Controls","minConfidence","TinyFaceDetectorControls","inputSize","scoreThreshold","TinyFaceDetectorOptions","e","target","inputSizes","size","FaceDetectorSelectionDialog","onFaceDetectionOptionsChanged","faceDetectionOptions","setState","renderSelection","state","item","renderControls","initialFaceDetectionOptions","render","onClose","React","FaceDetectorSelection","onCloseDialog","isDialogOpen","onOpenDialog","dialog","MediaElement","element","_element","ImageWithOverlay","isLoaded","onImageLoaded","bind","onImageRef","onCanvasRef","img","overlay","height","width","onLoaded","mediaElement","el","shouldComponentUpdate","nextProps","imageSrc","componentDidUpdate","componentDidMount","Object","assign","position","containerStyle","imageStyle","top","left","canvasStyle","FileSelectionControls","items","selectedFile","Container","Margin","SelectionTypes","SelectableInputElement","src","initialSrc","onChangeSelection","onLoadFromDisk","file","files","reader","FileReader","onload","loadEvent","result","readAsDataURL","selectionType","mediaElementStyle","renderMediaElement","renderAdditionalControls","SELECT","BOTH","FILE","accept","mediaElementId","display","defaultProps","SelectableImage","CenterContent","flexDirection","VideoWithOverlay","onVideoRef","onPlay","video","getBoundingClientRect","componentWillReceiveProps","srcObject","videoStyle","PLAYBACK_RATES","PlayButtonContainer","PlayButton","Mui","ProgressBar","Progress","SelectableVideo","isPlaying","isShowPlayControls","playbackRate","onPause","videoRef","pause","play","onChangePlaybackRate","onJumpTo","x","clientX","ratio","duration","currentTime","setTimeout","onTimeUpdate","progressRef","fpsRef","document","getElementById","round","getFps","style","refs","ontimeupdate","opacity","rate","shrink","WebcamVideoWithOverlay","navigator","mediaDevices","getUserMedia","error","toString","background","color","maxWidth","maxVideoWidth","InputComponent","IMAGE","maxHeight","VIDEO","WEBCAM","ModalLoader","title","linkCss","css","StyledLink","Link","StyledAbsLink","a","styles","theme","paper","sideMenuWidth","SideMenuComponent","renderDrawer","isSm","menu","onToggle","paddingLeft","linkTo","isOpen","keepMounted","classes","SideMenu","withStyles","MENU_ITEMS","pageContent","right","padding","marginLeft","breakpoints","up","PageLayoutComponent","isSideMenuOpen","toggleMenu","zIndex","children","PageLayout","getPageContext","require","default","Root","context","pageContext","sheetsManager","AppBarContainer","ControlsContainer","BasePage","isFaceDetectorLoaded","areModelsLoaded","currentFps","fpsMeter","changeFaceDetector","prevDetectorName","loadFaceDetector","onInputTypeChanged","updateFpsMeter","ts","slice","avgTimeInMs","total","t","length","processInputs","detector","processFrames","processId","Date","now","startProcessingFrames","faceDetector","loadFromUri","loadModels","Promise","all","faceLandmark68Net","loadAdditionalModels","componentWillUnmount","window","renderChildren","createMuiTheme","palette","primary","lightBlue","contrastText","createPageContext","Map","sheetsRegistry","SheetsRegistry","generateClassName","createGenerateClassName","process","browser","global","__INIT_MATERIAL_UI__"],"mappings":"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","file":"1-1cb2d092993fc21515c3.js","sourcesContent":["import styled from 'styled-components';\r\n\r\nexport type SideBySideProps = {\r\n  alignItems?: string\r\n}\r\n\r\nexport const SideBySide = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: ${(props: SideBySideProps) => props.alignItems || 'center'};\r\n`","import { withPrefix } from 'gatsby-link';\r\n\r\nexport const DOCS_URI = withPrefix('/docs/globals.html')\r\n\r\nexport const EXAMPLE_IMAGES = [1, 2, 3, 4, 5]\r\n  .map(idx => `bbt${idx}.jpg`)\r\n  .map(label => ({\r\n    label,\r\n    url: withPrefix(`/images/${label}`)\r\n  }))\r\n\r\nexport const EXAMPLE_IMAGES_FACE_EXPRESSIONS = [\r\n  'happy',\r\n  'sad',\r\n  'angry',\r\n  'disgusted',\r\n  'surprised',\r\n  'fearful',\r\n  'neutral'\r\n]\r\n  .map(expression => `${expression}.jpg`)\r\n  .map(label => ({\r\n    label,\r\n    url: withPrefix(`/images/${label}`)\r\n  }))\r\n\r\nexport const ALIGNED_FACE_IMAGES_BY_CLASS = ['amy', 'bernadette', 'howard', 'leonard', 'penny', 'raj', 'sheldon', 'stuart']\r\n  .map(\r\n    clazz => [1, 2, 3, 4, 5]\r\n      .map(idx => `${clazz}${idx}.png`)\r\n      .map(label => ({\r\n        label,\r\n        url: withPrefix(`/images/${clazz}/${label}`)\r\n      }))\r\n  )\r\n\r\nexport const EXAMPLE_VIDEOS = [\r\n  `bbt.mp4`\r\n].map(label => ({\r\n  label,\r\n  url: withPrefix(`/media/${label}`)\r\n}))\r\n\r\nexport const MODELS_URI = withPrefix(`/models`)\r\n\r\nexport const ALIGNED_FACE_IMAGES = ALIGNED_FACE_IMAGES_BY_CLASS\r\n  .reduce((flat, arr) => flat.concat(arr), [])","import * as Mui from '@material-ui/core';\r\nimport * as MuiIcons from '@material-ui/icons';\r\nimport * as React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst TabComponent = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  svg {\r\n    margin-left: 8px;\r\n  }\r\n`\r\n\r\nexport enum InputType {\r\n  IMAGE = 0,\r\n  WEBCAM = 1,\r\n  VIDEO = 2\r\n}\r\n\r\nexport type InputTypeTabsProps = {\r\n  inputType: InputType\r\n  onChange: (inputType: InputType) => any\r\n}\r\n\r\nexport const InputTypeTabs = ({ inputType, onChange }: InputTypeTabsProps) =>\r\n  <Mui.AppBar position=\"static\">\r\n    <Mui.Tabs value={inputType} onChange={(_: any, inputType: InputType) => onChange(inputType)}>\r\n      <Mui.Tab icon={<TabComponent><span>Image</span> <MuiIcons.Image /></TabComponent>} />\r\n      <Mui.Tab icon={<TabComponent><span>Webcam</span><MuiIcons.Videocam /></TabComponent>} />\r\n      <Mui.Tab icon={<TabComponent><span>Video</span><MuiIcons.VideoLibrary /></TabComponent>} />\r\n    </Mui.Tabs>\r\n  </Mui.AppBar>","import * as faceapi from 'face-api.js';\r\n\r\nconst TINY_FACE_DETECTOR = 'Tiny Face Detector'\r\nconst SSD_MOBILENET_V1 = 'SSD Mobilenet V1'\r\nconst MTCNN = 'MTCNN'\r\n\r\nexport const FACE_DETECTORS = [\r\n  SSD_MOBILENET_V1,\r\n  TINY_FACE_DETECTOR,\r\n  MTCNN\r\n]\r\n\r\nexport function getFaceDetectorNameFromOptions(options: faceapi.FaceDetectionOptions) {\r\n  if (options instanceof faceapi.SsdMobilenetv1Options) {\r\n    return SSD_MOBILENET_V1\r\n  }\r\n  if (options instanceof faceapi.TinyFaceDetectorOptions) {\r\n    return TINY_FACE_DETECTOR\r\n  }\r\n  if (options instanceof faceapi.MtcnnOptions) {\r\n    return MTCNN\r\n  }\r\n  throw new Error(`getFaceDetectorNameFromOptions - invalid face detector options`)\r\n}\r\n\r\nexport function createDefaultFaceDetectorOptionsFromName(detectorName: string) {\r\n  if (detectorName === SSD_MOBILENET_V1) {\r\n    return new faceapi.SsdMobilenetv1Options()\r\n  }\r\n  if (detectorName === TINY_FACE_DETECTOR) {\r\n    return new faceapi.TinyFaceDetectorOptions()\r\n  }\r\n  if (detectorName === MTCNN) {\r\n    return new faceapi.MtcnnOptions()\r\n  }\r\n  throw new Error(`getFaceDetectorNameFromOptions - invalid detectorName: ${detectorName}`)\r\n}\r\n\r\nexport function getFaceDetectionNetFromName(detectorName: string) {\r\n  if (detectorName === SSD_MOBILENET_V1) {\r\n    return faceapi.nets.ssdMobilenetv1\r\n  }\r\n  if (detectorName === TINY_FACE_DETECTOR) {\r\n    return faceapi.nets.tinyFaceDetector\r\n  }\r\n  if (detectorName === MTCNN) {\r\n    return faceapi.nets.mtcnn\r\n  }\r\n  throw new Error(`getFaceDetectionNetFromName - invalid detectorName: ${detectorName}`)\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as React from 'react';\r\n\r\nimport { SideBySide } from './styled/SideBySide';\r\n\r\nexport type AdjustableInputProps = {\r\n  inputId: string\r\n  label: string\r\n  value: number\r\n  minValue: number\r\n  maxValue: number\r\n  step: number\r\n  onChange: (newValue: number) => any\r\n}\r\n\r\nexport const AdjustableInput = (props: AdjustableInputProps) =>\r\n  <Mui.FormControl>\r\n    <SideBySide>\r\n      <Mui.InputLabel htmlFor={props.inputId}>\r\n        { props.label }\r\n      </Mui.InputLabel>\r\n      <Mui.Input\r\n        id={props.inputId}\r\n        value={props.value}\r\n      />\r\n      <Mui.Button\r\n        variant=\"outlined\"\r\n        onClick={\r\n          () => props.onChange(Math.max(props.value - props.step, props.minValue))\r\n        }\r\n      >\r\n        -\r\n      </Mui.Button>\r\n      <Mui.Button\r\n        variant=\"outlined\"\r\n        onClick={\r\n          () => props.onChange(Math.min(props.value + props.step, props.maxValue))\r\n        }\r\n      >\r\n        +\r\n      </Mui.Button>\r\n    </SideBySide>\r\n  </Mui.FormControl>","import * as Mui from '@material-ui/core';\r\nimport * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { AdjustableInput } from '../AdjustableInput';\r\n\r\nexport interface MtcnnControlsProps {\r\n  detectionParams: faceapi.MtcnnOptions\r\n  onParamsChanged: (detectionParams: faceapi.MtcnnOptions) => any\r\n}\r\n\r\nexport const MtcnnControls = (props: MtcnnControlsProps) => {\r\n\r\n  const assignOptions = (partial: Partial<faceapi.IMtcnnOptions>): faceapi.MtcnnOptions => {\r\n    const { scaleFactor, minFaceSize } = props.detectionParams\r\n    return new faceapi.MtcnnOptions({ scaleFactor, minFaceSize, ...partial })\r\n  }\r\n\r\n  return (\r\n    <Mui.FormControl>\r\n      <AdjustableInput\r\n        inputId=\"scaleFactor\"\r\n        label=\"scaleFactor:\"\r\n        value={props.detectionParams.scaleFactor}\r\n        minValue={0.1}\r\n        maxValue={0.9}\r\n        step={0.05}\r\n        onChange={\r\n          (scaleFactor: number) => props.onParamsChanged(\r\n            assignOptions({ scaleFactor })\r\n          )\r\n        }\r\n      />\r\n      <AdjustableInput\r\n        inputId=\"minFaceSize\"\r\n        label=\"minFaceSize:\"\r\n        value={props.detectionParams.minFaceSize}\r\n        minValue={40}\r\n        maxValue={400}\r\n        step={40}\r\n        onChange={\r\n          (minFaceSize: number) => props.onParamsChanged(\r\n            assignOptions({ minFaceSize })\r\n          )\r\n        }\r\n      />\r\n    </Mui.FormControl>\r\n  )\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { AdjustableInput } from '../AdjustableInput';\r\n\r\nexport interface SsdMobilenetv1ControlsProps {\r\n  detectionParams: faceapi.SsdMobilenetv1Options\r\n  onParamsChanged: (detectionParams: faceapi.SsdMobilenetv1Options) => any\r\n}\r\n\r\nexport const SsdMobilenetv1Controls = (props: SsdMobilenetv1ControlsProps) => {\r\n\r\n  const assignOptions = (partial: Partial<faceapi.ISsdMobilenetv1Options>): faceapi.SsdMobilenetv1Options => {\r\n    const { minConfidence } = props.detectionParams\r\n    return new faceapi.SsdMobilenetv1Options({ minConfidence, ...partial })\r\n  }\r\n\r\n  return (\r\n    <Mui.FormControl>\r\n      <AdjustableInput\r\n        inputId=\"minConfidence\"\r\n        label=\"minConfidence:\"\r\n        value={props.detectionParams.minConfidence}\r\n        minValue={0.1}\r\n        maxValue={0.9}\r\n        step={0.1}\r\n        onChange={\r\n          (minConfidence: number) => props.onParamsChanged(\r\n            assignOptions({ minConfidence })\r\n          )\r\n        }\r\n      />\r\n    </Mui.FormControl>\r\n  )\r\n}","import * as Mui from '@material-ui/core';\r\nimport { ITinyFaceDetectorOptions, TinyFaceDetectorOptions } from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { AdjustableInput } from '../AdjustableInput';\r\n\r\nexport interface TinyFaceDetectorControlsProps {\r\n  inputSizes: number[]\r\n  detectionParams: TinyFaceDetectorOptions\r\n  onParamsChanged: (detectionParams: TinyFaceDetectorOptions) => any\r\n}\r\n\r\nexport const TinyFaceDetectorControls = (props: TinyFaceDetectorControlsProps) => {\r\n\r\n  const assignOptions = (partial: Partial<ITinyFaceDetectorOptions>): TinyFaceDetectorOptions => {\r\n    const { inputSize, scoreThreshold } = props.detectionParams\r\n    return new TinyFaceDetectorOptions({ inputSize, scoreThreshold, ...partial })\r\n  }\r\n\r\n  return (\r\n    <Mui.FormControl>\r\n      <Mui.FormControl>\r\n        <Mui.InputLabel htmlFor=\"selectInputSize\">\r\n          Input Size\r\n        </Mui.InputLabel>\r\n        <Mui.Select\r\n          value={props.detectionParams.inputSize}\r\n          onChange={\r\n            (e: any) => props.onParamsChanged(\r\n              assignOptions({ inputSize: e.target.value })\r\n            )\r\n          }\r\n          input={<Mui.Input />}\r\n          id=\"selectInputSize\"\r\n        >\r\n          {\r\n            props.inputSizes.map((size: number) =>\r\n              <Mui.MenuItem\r\n                key={size}\r\n                value={size}\r\n              >\r\n                { size }\r\n              </Mui.MenuItem>\r\n            )\r\n          }\r\n        </Mui.Select>\r\n      </Mui.FormControl>\r\n      <AdjustableInput\r\n        inputId=\"scoreThreshold\"\r\n        label=\"scoreThreshold:\"\r\n        value={props.detectionParams.scoreThreshold}\r\n        minValue={0.1}\r\n        maxValue={0.9}\r\n        step={0.1}\r\n        onChange={\r\n          (scoreThreshold: number) => props.onParamsChanged(\r\n            assignOptions({ scoreThreshold })\r\n          )\r\n        }\r\n      />\r\n    </Mui.FormControl>\r\n  )\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { createDefaultFaceDetectorOptionsFromName, FACE_DETECTORS, getFaceDetectorNameFromOptions } from './const';\r\nimport { MtcnnControls } from './MtcnnControls';\r\nimport { SsdMobilenetv1Controls } from './SsdMobilenetv1Controls';\r\nimport { TinyFaceDetectorControls } from './TinyFaceDetectorControls';\r\n\r\nexport interface FaceDetectorSelectionDialogProps {\r\n  initialFaceDetectionOptions: faceapi.FaceDetectionOptions\r\n  onClose: (faceDetectionOptions: faceapi.FaceDetectionOptions) => any\r\n}\r\n\r\nexport interface FaceDetectorSelectionState {\r\n  faceDetectionOptions: faceapi.FaceDetectionOptions\r\n}\r\n\r\nexport class FaceDetectorSelectionDialog extends React.Component<FaceDetectorSelectionDialogProps, FaceDetectorSelectionState> {\r\n  constructor(props: FaceDetectorSelectionDialogProps) {\r\n    super(props)\r\n    this.state = {\r\n      faceDetectionOptions: props.initialFaceDetectionOptions\r\n    }\r\n  }\r\n\r\n  onFaceDetectionOptionsChanged = (faceDetectionOptions: faceapi.FaceDetectionOptions) => {\r\n    this.setState({ faceDetectionOptions })\r\n  }\r\n\r\n  renderSelection = () =>\r\n    <div>\r\n      <Mui.InputLabel htmlFor=\"Dialog\">\r\n        Choose face detector:\r\n      </Mui.InputLabel>\r\n      <Mui.Select\r\n        value={getFaceDetectorNameFromOptions(this.state.faceDetectionOptions)}\r\n        onChange={e => this.setState({ faceDetectionOptions: createDefaultFaceDetectorOptionsFromName(e.target.value) })}\r\n        input={<Mui.Input />}\r\n        id=\"Dialog\"\r\n      >\r\n      {\r\n        FACE_DETECTORS.map(item =>\r\n          <Mui.MenuItem\r\n            key={item}\r\n            value={item}\r\n          >\r\n            { item }\r\n          </Mui.MenuItem>\r\n        )\r\n      }\r\n      </Mui.Select>\r\n    </div>\r\n\r\n  renderControls = () => {\r\n    if (this.state.faceDetectionOptions instanceof faceapi.SsdMobilenetv1Options) {\r\n      return (\r\n        <SsdMobilenetv1Controls\r\n          detectionParams={this.state.faceDetectionOptions}\r\n          onParamsChanged={this.onFaceDetectionOptionsChanged}\r\n        />\r\n      )\r\n    } else if (this.state.faceDetectionOptions instanceof faceapi.TinyFaceDetectorOptions) {\r\n      return (\r\n        <TinyFaceDetectorControls\r\n          inputSizes={[128, 160, 224, 320, 416, 512, 608]}\r\n          detectionParams={this.state.faceDetectionOptions}\r\n          onParamsChanged={this.onFaceDetectionOptionsChanged}\r\n        />\r\n      )\r\n    } else if (this.state.faceDetectionOptions instanceof faceapi.MtcnnOptions) {\r\n      return (\r\n        <MtcnnControls\r\n          detectionParams={this.state.faceDetectionOptions}\r\n          onParamsChanged={this.onFaceDetectionOptionsChanged}\r\n        />\r\n      )\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Mui.Dialog\r\n        disableBackdropClick\r\n        disableEscapeKeyDown\r\n        open={true}\r\n      >\r\n        <Mui.DialogTitle>\r\n          { 'Face Detector Options' }\r\n        </Mui.DialogTitle>\r\n        <Mui.DialogContent>\r\n          {\r\n            <Mui.FormControl>\r\n              { this.renderSelection() }\r\n              { this.renderControls() }\r\n              <Mui.Button variant='outlined' onClick={() => this.props.onClose(this.state.faceDetectionOptions)}>\r\n                { 'Save' }\r\n              </Mui.Button>\r\n            </Mui.FormControl>\r\n          }\r\n        </Mui.DialogContent>\r\n      </Mui.Dialog>\r\n    )\r\n  }\r\n}\r\n","import * as Mui from '@material-ui/core';\r\nimport * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\n\r\nimport { getFaceDetectorNameFromOptions } from './const';\r\nimport { FaceDetectorSelectionDialog } from './FaceDetectorSelectionDialog';\r\n\r\nexport interface FaceDetectorSelectionProps {\r\n  faceDetectionOptions: faceapi.FaceDetectionOptions\r\n  onFaceDetectionOptionsChanged: (options: faceapi.FaceDetectionOptions) => any\r\n}\r\n\r\nexport interface FaceDetectorSelectionState {\r\n  isDialogOpen: boolean\r\n}\r\n\r\nexport class FaceDetectorSelection extends React.Component<FaceDetectorSelectionProps, FaceDetectorSelectionState> {\r\n  constructor(props: FaceDetectorSelectionProps) {\r\n    super(props)\r\n    this.state = {\r\n      isDialogOpen: false\r\n    }\r\n  }\r\n\r\n  onCloseDialog = (faceDetectionOptions: faceapi.FaceDetectionOptions) => {\r\n    this.setState({ isDialogOpen: false })\r\n    if (this.props.faceDetectionOptions !== faceDetectionOptions) {\r\n      this.props.onFaceDetectionOptionsChanged(faceDetectionOptions)\r\n    }\r\n  }\r\n\r\n  onOpenDialog = () => {\r\n    this.setState({ isDialogOpen: true })\r\n  }\r\n\r\n  render() {\r\n    const dialog = this.state.isDialogOpen\r\n      ?\r\n        <FaceDetectorSelectionDialog\r\n          initialFaceDetectionOptions={this.props.faceDetectionOptions}\r\n          onClose={this.onCloseDialog}\r\n        />\r\n      : null\r\n\r\n    return (\r\n      <div>\r\n        { dialog }\r\n        <Mui.Button variant='outlined' onClick={this.onOpenDialog}>\r\n          { getFaceDetectorNameFromOptions(this.props.faceDetectionOptions) }\r\n        </Mui.Button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { TMediaElement } from 'face-api.js';\r\n\r\nexport class MediaElement<T extends TMediaElement = TMediaElement> {\r\n  private _element: T\r\n\r\n  constructor(element: T) {\r\n    this._element = element\r\n  }\r\n\r\n  public get element(): T {\r\n    return this._element\r\n  }\r\n}","import * as React from 'react';\r\n\r\nimport { MediaElement } from '../MediaElement';\r\n\r\nexport type ImageWithOverlayRefs = {\r\n  mediaElement: MediaElement<HTMLImageElement>,\r\n  overlay: HTMLCanvasElement\r\n}\r\n\r\nexport type ImageWithOverlayProps = {\r\n  imageSrc: string\r\n  onLoaded: (refs: ImageWithOverlayRefs) => any\r\n  containerStyle?: React.CSSProperties\r\n  imageStyle?: React.CSSProperties\r\n  canvasStyle?: React.CSSProperties\r\n}\r\n\r\nexport class ImageWithOverlay extends React.Component<ImageWithOverlayProps> {\r\n  img: HTMLImageElement | undefined\r\n  overlay: HTMLCanvasElement | undefined\r\n  isLoaded: boolean = false\r\n\r\n  constructor(props: ImageWithOverlayProps) {\r\n    super(props)\r\n\r\n    this.onImageLoaded = this.onImageLoaded.bind(this)\r\n    this.onImageRef = this.onImageRef.bind(this)\r\n    this.onCanvasRef = this.onCanvasRef.bind(this)\r\n    this.onChange = this.onChange.bind(this)\r\n  }\r\n\r\n  onChange() {\r\n    const { img, overlay, isLoaded } = this\r\n\r\n    if (img && overlay && isLoaded) {\r\n      this.overlay.height = this.img.height\r\n      this.overlay.width = this.img.width\r\n      this.props.onLoaded({ mediaElement: new MediaElement(img), overlay })\r\n    }\r\n  }\r\n\r\n  onImageLoaded() {\r\n    this.isLoaded = true\r\n    this.onChange()\r\n  }\r\n\r\n  onImageRef(el: HTMLImageElement) {\r\n    this.img = el\r\n    this.onChange()\r\n  }\r\n\r\n  onCanvasRef(el: HTMLCanvasElement) {\r\n    this.overlay = el\r\n    this.onChange()\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps: ImageWithOverlayProps) {\r\n    return nextProps.imageSrc !== this.props.imageSrc\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.onChange()\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onChange()\r\n  }\r\n\r\n  public render() {\r\n    return(\r\n      <div style={Object.assign({}, { position: 'relative' }, this.props.containerStyle)}>\r\n        <img\r\n          src={this.props.imageSrc}\r\n          ref={this.onImageRef}\r\n          style={Object.assign({}, this.props.imageStyle)}\r\n          onLoad={this.onImageLoaded}\r\n        />\r\n        <canvas\r\n          style={Object.assign({}, { position: 'absolute', top: 0, left: 0 }, this.props.canvasStyle)}\r\n          ref={this.onCanvasRef}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}","import { FormControl, FormHelperText, Input, MenuItem, Select } from '@material-ui/core';\r\nimport * as React from 'react';\r\n\r\nexport type FileSelectionControlsItem = {\r\n  url: string\r\n  label: string\r\n}\r\n\r\ntype FileSelectionControlsProps = {\r\n  items: FileSelectionControlsItem[]\r\n  selectedFile: string\r\n  onChange: (value: string) => void\r\n}\r\n\r\nexport const FileSelectionControls = ({ items, selectedFile, onChange }: FileSelectionControlsProps) =>\r\n  <FormControl>\r\n    <Select\r\n      value={selectedFile}\r\n      onChange={e => onChange(e.target.value)}\r\n      input={<Input />}\r\n    >\r\n      {\r\n        items.map(item =>\r\n          <MenuItem\r\n            key={item.url}\r\n            value={item.url}\r\n          >\r\n            { item.label }\r\n          </MenuItem>\r\n        )\r\n      }\r\n    </Select>\r\n    <FormHelperText>Pick a file</FormHelperText>\r\n  </FormControl>","import * as Mui from '@material-ui/core';\r\nimport * as React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { ReactElement } from '../types';\r\nimport { FileSelectionControls, FileSelectionControlsItem } from './FileSelectionControls';\r\nimport { ImageWithOverlayRefs } from './ImageWithOverlay';\r\nimport { SideBySide } from './styled/SideBySide';\r\nimport { VideoWithOverlayRefs } from './VideoWithOverlay';\r\n\r\nconst Container = styled.div`\r\n  padding: 10px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n`\r\n\r\nconst MediaElement = styled.div`\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 500px;\r\n  width: 800px;\r\n`\r\n\r\nconst Margin = styled.div`\r\n  margin: 10px;\r\n`\r\n\r\nexport enum SelectionTypes {\r\n  SELECT = 'SELECT',\r\n  FILE = 'FILE',\r\n  BOTH = 'BOTH'\r\n}\r\n\r\nexport type OnRefsLoadedCallback = (refs: ImageWithOverlayRefs | VideoWithOverlayRefs) => any\r\n\r\nexport type SelectableInputElementBaseProps = {\r\n  onLoaded: OnRefsLoadedCallback\r\n  mediaElementId: string\r\n  items?: FileSelectionControlsItem[]\r\n  initialSrc?: string\r\n  selectionType?: SelectionTypes\r\n  mediaElementStyle?: React.CSSProperties\r\n  getFps?: () => number\r\n}\r\n\r\nexport type SelectableInputElementProps = SelectableInputElementBaseProps & {\r\n  accept: string\r\n  renderMediaElement: (props: {\r\n    src: string,\r\n    onLoaded: OnRefsLoadedCallback,\r\n    mediaElementStyle?: React.CSSProperties\r\n  }) => ReactElement\r\n  renderAdditionalControls?: () => ReactElement\r\n}\r\n\r\nexport type SelectableInputElementState = {\r\n  src: string\r\n}\r\n\r\nexport class SelectableInputElement extends React.Component<SelectableInputElementProps, SelectableInputElementState> {\r\n  static defaultProps: Partial<SelectableInputElementProps> = {\r\n    selectionType: SelectionTypes.SELECT\r\n  }\r\n\r\n  constructor(props: SelectableInputElementProps) {\r\n    super(props)\r\n\r\n    this.state = {\r\n      src: props.initialSrc\r\n    }\r\n\r\n    this.onChangeSelection = this.onChangeSelection.bind(this)\r\n    this.onLoadFromDisk = this.onLoadFromDisk.bind(this)\r\n  }\r\n\r\n  onChangeSelection(src: string) {\r\n    this.setState({\r\n      src\r\n    })\r\n  }\r\n\r\n  onLoadFromDisk(e: any) {\r\n    const file = (e.target.files || [])[0]\r\n    if (!file) {\r\n      return\r\n    }\r\n\r\n    const reader = new FileReader()\r\n\r\n    reader.onload = (loadEvent: any) =>\r\n      this.setState({\r\n        src: loadEvent.target.result\r\n      })\r\n\r\n    reader.readAsDataURL(file)\r\n  }\r\n\r\n  render() {\r\n    const { selectionType, onLoaded, mediaElementStyle, renderMediaElement, renderAdditionalControls } = this.props\r\n    const { src } = this.state\r\n    return (\r\n      <Container>\r\n        <MediaElement>\r\n          { renderMediaElement({ src, onLoaded, mediaElementStyle }) }\r\n        </MediaElement>\r\n        <SideBySide>\r\n        {\r\n          (selectionType === SelectionTypes.SELECT || selectionType === SelectionTypes.BOTH)\r\n            &&\r\n            <Margin>\r\n              <FileSelectionControls\r\n                items={this.props.items}\r\n                selectedFile={this.state.src}\r\n                onChange={this.onChangeSelection}\r\n              />\r\n            </Margin>\r\n        }\r\n        {\r\n          (selectionType === SelectionTypes.FILE || selectionType === SelectionTypes.BOTH)\r\n            &&\r\n            <Margin>\r\n              <input\r\n                accept={this.props.accept}\r\n                id={this.props.mediaElementId}\r\n                multiple\r\n                style={{ display: 'none' }}\r\n                onChange={this.onLoadFromDisk}\r\n                type=\"file\"\r\n              />\r\n              <label htmlFor={this.props.mediaElementId}>\r\n                <Mui.Button variant=\"outlined\" component=\"span\">\r\n                  From Disk\r\n                </Mui.Button>\r\n              </label>\r\n            </Margin>\r\n        }\r\n        { renderAdditionalControls ? renderAdditionalControls() : null }\r\n        </SideBySide>\r\n      </Container>\r\n    )\r\n  }\r\n}","import * as React from 'react';\r\n\r\nimport { ImageWithOverlay } from './ImageWithOverlay';\r\nimport { SelectableInputElement, SelectableInputElementBaseProps } from './SelectableInputElement';\r\n\r\nexport class SelectableImage extends React.Component<SelectableInputElementBaseProps> {\r\n  render() {\r\n    return (\r\n      <SelectableInputElement\r\n        {...this.props}\r\n        accept=\"image/*\"\r\n        renderMediaElement={props =>\r\n          <ImageWithOverlay\r\n            imageSrc={props.src}\r\n            onLoaded={props.onLoaded}\r\n            imageStyle={props.mediaElementStyle}\r\n          />\r\n        }\r\n      />\r\n    )\r\n  }\r\n}","import styled from 'styled-components';\r\n\r\nexport type CenterContentProps = {\r\n  alignItems?: string,\r\n  flexDirection?: 'row' | 'column'\r\n}\r\n\r\nexport const CenterContent = styled.div`\r\n  display: flex;\r\n  align-items: ${(props: CenterContentProps) => props.alignItems || 'center'};\r\n  justify-content: center;\r\n  flex-direction: ${(props: CenterContentProps) => props.flexDirection || 'row'};\r\n  flex-wrap: wrap;\r\n`","import * as React from 'react';\r\n\r\nimport { MediaElement } from '../MediaElement';\r\n\r\nexport type VideoWithOverlayRefs = {\r\n  mediaElement: MediaElement<HTMLVideoElement>,\r\n  overlay: HTMLCanvasElement\r\n}\r\n\r\nexport type VideoWithOverlayProps = {\r\n  onLoaded?: (refs: VideoWithOverlayRefs) => any\r\n  onVideoRef?: () => any\r\n  videoStyle?: React.CSSProperties\r\n  src?: string\r\n  srcObject?: MediaStream | MediaSource | Blob | null\r\n}\r\n\r\nexport class VideoWithOverlay extends React.Component<VideoWithOverlayProps> {\r\n  video: HTMLVideoElement | undefined\r\n  overlay: HTMLCanvasElement | undefined\r\n  isLoaded: boolean = false\r\n\r\n  constructor(props: VideoWithOverlayProps) {\r\n    super(props)\r\n\r\n    this.onChange = this.onChange.bind(this)\r\n    this.onVideoRef = this.onVideoRef.bind(this)\r\n    this.onCanvasRef = this.onCanvasRef.bind(this)\r\n    this.onPlay = this.onPlay.bind(this)\r\n  }\r\n\r\n  onChange() {\r\n    const { video, overlay, isLoaded } = this\r\n\r\n    if (video && overlay && isLoaded) {\r\n      const { width, height } = this.video.getBoundingClientRect()\r\n      this.overlay.width = width,\r\n      this.overlay.height = height\r\n      this.props.onLoaded({ mediaElement: new MediaElement(video), overlay })\r\n    }\r\n  }\r\n\r\n  onVideoRef(el: HTMLVideoElement) {\r\n    this.video = el\r\n    this.props.onVideoRef && this.props.onVideoRef()\r\n    this.onChange()\r\n  }\r\n\r\n  onCanvasRef(el: HTMLCanvasElement) {\r\n    this.overlay = el\r\n    this.onChange()\r\n  }\r\n\r\n  onPlay() {\r\n    this.isLoaded = true\r\n    this.onChange()\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: VideoWithOverlayProps) {\r\n    const { srcObject } = nextProps\r\n    if (srcObject && this.props.srcObject !== srcObject) {\r\n      this.video.srcObject = srcObject\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps: VideoWithOverlayProps) {\r\n    return nextProps.src !== this.props.src\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.onChange()\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onChange()\r\n  }\r\n\r\n  public render() {\r\n    return(\r\n      <div style={{ position: 'relative' }}>\r\n        <video\r\n          muted\r\n          autoPlay\r\n          style={Object.assign({}, this.props.videoStyle)}\r\n          ref={this.onVideoRef}\r\n          onPlay={this.onPlay}\r\n          src={this.props.src}\r\n        />\r\n        <canvas\r\n          style={{ position: 'absolute', top: 0, left: 0 }}\r\n          ref={this.onCanvasRef}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as MuiIcons from '@material-ui/icons';\r\nimport * as React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { SelectableInputElement, SelectableInputElementBaseProps } from './SelectableInputElement';\r\nimport { CenterContent } from './styled/CenterContent';\r\nimport { SideBySide } from './styled/SideBySide';\r\nimport { VideoWithOverlay, VideoWithOverlayRefs } from './VideoWithOverlay';\r\n\r\nconst PLAYBACK_RATES = [1.0, 0.75, 0.5, 0.25]\r\n\r\nconst PlayButtonContainer = styled(CenterContent)`\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst PlayButton = styled(Mui.IconButton)`\r\n  svg {\r\n    font-size: 46px;\r\n    background: rgba(255, 255, 255, 0.6);\r\n    border-radius: 10px;\r\n    padding: 8px 16px;\r\n  }\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 0;\r\n`\r\n\r\nconst ProgressBar = styled.div`\r\n  position: absolute;\r\n  bottom: 8px;\r\n  left: 3%;\r\n  width: 94%;\r\n  height: 16px;\r\n  background: rgba(255, 255, 255, 0.6);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n`\r\n\r\nconst Progress = styled.div`\r\n  height: 100%;\r\n  width: 4%;\r\n  background: rgba(0, 0, 0, 0.8);\r\n  border-radius: 8px;\r\n  cursor: pointer;\r\n`\r\n\r\nconst Margin = styled.div`\r\n  margin: 10px;\r\n`\r\n\r\nexport type SelectableVideoState = {\r\n  isPlaying: boolean\r\n  isShowPlayControls: boolean\r\n  playbackRate: number\r\n}\r\n\r\nexport class SelectableVideo extends React.Component<SelectableInputElementBaseProps, SelectableVideoState> {\r\n  videoRef: HTMLVideoElement\r\n  progressRef: HTMLElement\r\n\r\n  state: SelectableVideoState = {\r\n    isPlaying: false,\r\n    isShowPlayControls: false,\r\n    playbackRate: PLAYBACK_RATES[0]\r\n  }\r\n\r\n  onPause = () => {\r\n    if (!this.videoRef) {\r\n      return\r\n    }\r\n    this.videoRef.pause()\r\n    this.setState({ isPlaying: false })\r\n  }\r\n\r\n  onPlay = () => {\r\n    if (!this.videoRef) {\r\n      return\r\n    }\r\n    this.videoRef.play()\r\n    this.setState({ isPlaying: true })\r\n  }\r\n\r\n  onChangePlaybackRate = (e: any) => {\r\n    if (!this.videoRef) {\r\n      return\r\n    }\r\n    const playbackRate = e.target.value\r\n    this.videoRef.playbackRate = playbackRate\r\n    this.setState({ playbackRate })\r\n  }\r\n\r\n  onJumpTo = (e: any) => {\r\n    if (!this.videoRef) {\r\n      return\r\n    }\r\n    const { left, width } = e.target.getBoundingClientRect()\r\n    const x = e.clientX - left\r\n    const ratio = (x / width)\r\n    const { duration } = this.videoRef\r\n    this.videoRef.currentTime = ratio * duration\r\n    // TODO: figure out why detection stops without timeout?\r\n    this.videoRef.pause()\r\n    setTimeout(() => this.videoRef.play(), 500)\r\n  }\r\n\r\n  onTimeUpdate = (e: any) => {\r\n    if (this.videoRef !== e.target || !this.progressRef) {\r\n      return\r\n    }\r\n    const { currentTime, duration } = this.videoRef\r\n    const fpsRef = document.getElementById('fps')\r\n    fpsRef && (fpsRef.value = `${Math.round(this.props.getFps())}`)\r\n    this.progressRef.style['margin-left'] = `${96 * (currentTime / duration)}%`\r\n  }\r\n\r\n  onLoaded = (refs: VideoWithOverlayRefs) => {\r\n    this.videoRef = refs.mediaElement.element\r\n    this.props.onLoaded(refs)\r\n    this.setState({ isPlaying: true })\r\n    this.videoRef.ontimeupdate = this.onTimeUpdate\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <SelectableInputElement\r\n          {...this.props}\r\n          accept=\"video/*\"\r\n          renderMediaElement={props =>\r\n            <div style={{ position: 'relative' }}>\r\n              <VideoWithOverlay\r\n                src={props.src}\r\n                onLoaded={this.onLoaded}\r\n                videoStyle={props.mediaElementStyle}\r\n              />\r\n              <PlayButtonContainer\r\n                style={{ opacity: this.state.isShowPlayControls ? 1 : 0 }}\r\n                onMouseEnter={() => this.setState({ isShowPlayControls: true })}\r\n                onMouseLeave={() => this.setState({ isShowPlayControls: false })}\r\n              >\r\n                <PlayButton\r\n                  onClick={this.state.isPlaying ? this.onPause : this.onPlay}\r\n                >\r\n                  { this.state.isPlaying ? <MuiIcons.Pause /> : <MuiIcons.PlayArrow /> }\r\n                </PlayButton>\r\n              </PlayButtonContainer>\r\n              <ProgressBar onClick={this.onJumpTo}>\r\n                <Progress\r\n                  ref={progressRef => this.progressRef = progressRef}\r\n                >\r\n                </Progress>\r\n              </ProgressBar>\r\n            </div>\r\n          }\r\n          renderAdditionalControls={() =>\r\n            <SideBySide>\r\n              <Margin>\r\n                <Mui.FormControl>\r\n                  <Mui.Select\r\n                    value={this.state.playbackRate}\r\n                    onChange={this.onChangePlaybackRate}\r\n                    input={<Mui.Input />}\r\n                  >\r\n                    {\r\n                      PLAYBACK_RATES.map(rate =>\r\n                        <Mui.MenuItem\r\n                          key={rate}\r\n                          value={rate}\r\n                        >\r\n                          { rate }\r\n                        </Mui.MenuItem>\r\n                      )\r\n                    }\r\n                  </Mui.Select>\r\n                  <Mui.FormHelperText>Playback Rate</Mui.FormHelperText>\r\n                </Mui.FormControl>\r\n              </Margin>\r\n              <Margin>\r\n                <Mui.TextField\r\n                  label=\"FPS\"\r\n                  id=\"fps\"\r\n                  InputLabelProps={{\r\n                    shrink: true\r\n                  }}\r\n                  margin=\"normal\"\r\n                  variant=\"outlined\"\r\n                />\r\n              </Margin>\r\n            </SideBySide>\r\n          }\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}","import * as React from 'react';\r\n\r\nimport { VideoWithOverlay, VideoWithOverlayRefs } from './VideoWithOverlay';\r\n\r\nexport type WebcamVideoWithOverlayProps = {\r\n  onLoaded: (refs: VideoWithOverlayRefs) => any\r\n  maxVideoWidth?: number\r\n}\r\n\r\ntype WebcamVideoWithOverlayState = {\r\n  srcObject?: MediaStream | MediaSource | Blob | null\r\n  error?: string\r\n}\r\n\r\nexport class WebcamVideoWithOverlay extends React.Component<WebcamVideoWithOverlayProps, WebcamVideoWithOverlayState> {\r\n  state: WebcamVideoWithOverlayState = {\r\n  }\r\n\r\n  onVideoRef = async () => {\r\n    try {\r\n      const srcObject = await navigator.mediaDevices.getUserMedia({ video: {} })\r\n      this.setState({ srcObject })\r\n    } catch (err) {\r\n      this.setState({ error: err.toString() })\r\n    }\r\n  }\r\n\r\n  public render() {\r\n    if (this.state.error) {\r\n      return (\r\n        <div style={{ background: 'red', color: 'white' }}>\r\n          <h3> Error occured while requesting webcam access: </h3>\r\n          <p> { this.state.error } </p>\r\n        </div>\r\n      )\r\n    }\r\n\r\n    return(\r\n      <VideoWithOverlay\r\n        srcObject={this.state.srcObject}\r\n        onLoaded={this.props.onLoaded}\r\n        videoStyle={{ maxWidth: this.props.maxVideoWidth }}\r\n        onVideoRef={this.onVideoRef}\r\n      />\r\n    )\r\n  }\r\n}","import * as React from 'react';\r\n\r\nimport { EXAMPLE_IMAGES, EXAMPLE_IMAGES_FACE_EXPRESSIONS, EXAMPLE_VIDEOS } from '../const';\r\nimport { ImageWithOverlayRefs } from './ImageWithOverlay';\r\nimport { InputType } from './InputTypeTabs';\r\nimport { SelectableImage } from './SelectableImage';\r\nimport { SelectionTypes } from './SelectableInputElement';\r\nimport { SelectableVideo } from './SelectableVideo';\r\nimport { VideoWithOverlayRefs } from './VideoWithOverlay';\r\nimport { WebcamVideoWithOverlay } from './WebcamVideoWithOverlay';\r\n\r\nexport type InputComponentProps = {\r\n  inputType: InputType\r\n  onLoaded: (refs: ImageWithOverlayRefs | VideoWithOverlayRefs) => any\r\n  getFps: () => number\r\n}\r\n\r\nexport const InputComponent = ({ inputType, onLoaded, getFps }: InputComponentProps) => {\r\n  if (inputType === InputType.IMAGE) {\r\n    return (\r\n      <SelectableImage\r\n        items={[...EXAMPLE_IMAGES, ...EXAMPLE_IMAGES_FACE_EXPRESSIONS]}\r\n        initialSrc={EXAMPLE_IMAGES[0].url}\r\n        onLoaded={onLoaded}\r\n        selectionType={SelectionTypes.BOTH}\r\n        mediaElementStyle={{ maxWidth: 800, maxHeight: 500 }}\r\n        mediaElementId=\"img\"\r\n      />\r\n    )\r\n  }\r\n  if (inputType === InputType.VIDEO) {\r\n    return (\r\n      <SelectableVideo\r\n        items={EXAMPLE_VIDEOS}\r\n        initialSrc={EXAMPLE_VIDEOS[0].url}\r\n        onLoaded={onLoaded}\r\n        selectionType={SelectionTypes.BOTH}\r\n        mediaElementStyle={{ maxWidth: 800, maxHeight: 500 }}\r\n        mediaElementId=\"video\"\r\n        getFps={getFps}\r\n      />\r\n    )\r\n  }\r\n  if (inputType === InputType.WEBCAM) {\r\n    return (\r\n      <WebcamVideoWithOverlay\r\n        onLoaded={onLoaded}\r\n        maxVideoWidth={800}\r\n      />\r\n    )\r\n  }\r\n  return null\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as React from 'react';\r\n\r\nexport interface ModalLoaderProps {\r\n  title: string\r\n}\r\n\r\nexport const ModalLoader = (props: ModalLoaderProps) =>\r\n  <Mui.Dialog\r\n    disableBackdropClick\r\n    disableEscapeKeyDown\r\n    open={true}\r\n  >\r\n    <Mui.DialogTitle>\r\n      { props.title }\r\n    </Mui.DialogTitle>\r\n    <Mui.DialogContent>\r\n      <Mui.LinearProgress />\r\n    </Mui.DialogContent>\r\n  </Mui.Dialog>","import Link from 'gatsby-link';\r\nimport styled, { css } from 'styled-components';\r\n\r\nconst linkCss = css`\r\n  padding: 4px;\r\n  color: inherit;\r\n  text-decoration: none;\r\n  display: block;\r\n`\r\n\r\nexport const StyledLink = styled(Link)`\r\n  ${linkCss}\r\n`\r\n\r\nexport const StyledAbsLink = styled.a`\r\n  ${linkCss}\r\n`","import { Divider, Drawer, Hidden, IconButton, List, ListItem } from '@material-ui/core';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport * as React from 'react';\r\n\r\nimport { DOCS_URI } from '../const';\r\nimport { StyledAbsLink, StyledLink } from './styled/StyledLink';\r\n\r\nexport type MenuItem = {\r\n  label: string\r\n  linkTo: string\r\n}\r\n\r\ntype SideMenuProps = {\r\n  items: MenuItem[]\r\n  isOpen: boolean\r\n  classes: any\r\n  onToggle: () => any\r\n}\r\n\r\nconst styles = (theme: any) => ({\r\n  paper: {\r\n    width: theme.sideMenuWidth\r\n  }\r\n})\r\n\r\nclass SideMenuComponent extends React.Component<SideMenuProps> {\r\n  renderDrawer(isSm: boolean) {\r\n    const menu = (\r\n      <div>\r\n        {\r\n          isSm &&\r\n            <IconButton\r\n              aria-label=\"open drawer\"\r\n              onClick={this.props.onToggle}\r\n            >\r\n              <MenuIcon />\r\n            </IconButton>\r\n        }\r\n        <StyledAbsLink href=\"https://github.com/justadudewhohacks/face-api.js\">\r\n          <h3 style={{ paddingLeft: 24 }}> face-api.js </h3>\r\n        </StyledAbsLink>\r\n        <Divider />\r\n        <StyledAbsLink href={DOCS_URI}>\r\n          <h3 style={{ paddingLeft: 24 }}> API Documentation </h3>\r\n        </StyledAbsLink>\r\n        <Divider />\r\n        <List>\r\n          {\r\n            this.props.items.map(\r\n              item =>\r\n                <ListItem key={item.linkTo}>\r\n                  <StyledLink to={item.linkTo}>\r\n                    { item.label }\r\n                  </StyledLink>\r\n                </ListItem>\r\n            )\r\n          }\r\n        </List>\r\n      </div>\r\n    )\r\n\r\n    return (\r\n      <Drawer\r\n        anchor=\"left\"\r\n        variant={isSm ? 'temporary' : 'permanent'}\r\n        open={this.props.isOpen}\r\n        onClose={isSm ? this.props.onToggle : () => {}}\r\n        ModalProps={{\r\n          keepMounted: true\r\n        }}\r\n        classes={{\r\n          paper: this.props.classes.paper\r\n        }}\r\n      >\r\n        { menu }\r\n      </Drawer>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Hidden mdUp>\r\n          { this.renderDrawer(true) }\r\n        </Hidden>\r\n        <Hidden smDown>\r\n          { this.renderDrawer(false) }\r\n        </Hidden>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport const SideMenu = withStyles(styles)(SideMenuComponent)","import { IconButton } from '@material-ui/core';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport * as React from 'react';\r\n\r\nimport { SideMenu } from '../components/SideMenu';\r\nimport { CenterContent } from '../components/styled/CenterContent';\r\n\r\nconst MENU_ITEMS = [\r\n  { label: 'Face Classification', linkTo: '/face_classification' },\r\n  { label: 'Face Recognition', linkTo: '/face_recognition' }\r\n]\r\n\r\nconst styles = (theme: any) => ({\r\n  pageContent: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    maxWidth: '800px',\r\n    padding: '10px',\r\n    marginLeft: '0px',\r\n    [theme.breakpoints.up('md')]: {\r\n      marginLeft: theme.sideMenuWidth\r\n    }\r\n  }\r\n})\r\n\r\ntype PageLayoutProps = {\r\n  classes: any\r\n}\r\n\r\ntype PageLayoutState = {\r\n  isSideMenuOpen: boolean\r\n}\r\n\r\nclass PageLayoutComponent extends React.Component<PageLayoutProps, PageLayoutState> {\r\n  state: PageLayoutState = {\r\n    isSideMenuOpen: false\r\n  }\r\n\r\n  toggleMenu = () => {\r\n    this.setState(state => ({ isSideMenuOpen: !state.isSideMenuOpen }))\r\n  }\r\n\r\n  public render() {\r\n    return (\r\n      <div>\r\n        <IconButton\r\n          aria-label=\"open drawer\"\r\n          onClick={this.toggleMenu}\r\n          style={{ zIndex: 999 }}\r\n        >\r\n          <MenuIcon />\r\n        </IconButton>\r\n        <SideMenu\r\n          items={MENU_ITEMS}\r\n          isOpen={this.state.isSideMenuOpen}\r\n          onToggle={this.toggleMenu}\r\n        />\r\n        <div className={this.props.classes.pageContent}>\r\n          <CenterContent>\r\n            { this.props.children }\r\n          </CenterContent>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n}\r\n\r\nexport const PageLayout = withStyles(styles as any)(PageLayoutComponent)","import { MuiThemeProvider } from '@material-ui/core';\r\nimport * as React from 'react';\r\n\r\nimport { PageLayout } from './layouts/PageLayout';\r\n\r\nconst getPageContext = require('./getPageContext').default\r\n\r\nexport class Root extends React.Component {\r\n\r\n  pageContext: any = {}\r\n\r\n  constructor(props: any, context: any){\r\n    super(props, context)\r\n    this.pageContext = getPageContext()\r\n  }\r\n\r\n  public render() {\r\n    return(\r\n      <MuiThemeProvider\r\n        theme={this.pageContext.theme}\r\n        sheetsManager={this.pageContext.sheetsManager}\r\n      >\r\n        <PageLayout>\r\n          { this.props.children }\r\n        </PageLayout>\r\n      </MuiThemeProvider>\r\n    )\r\n  }\r\n}","import * as Mui from '@material-ui/core';\r\nimport * as faceapi from 'face-api.js';\r\nimport * as React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nimport { FaceDetectorSelection } from '../components/FaceDetectorSelection';\r\nimport { getFaceDetectionNetFromName, getFaceDetectorNameFromOptions } from '../components/FaceDetectorSelection/const';\r\nimport { InputComponent } from '../components/InputComponent';\r\nimport { InputType, InputTypeTabs } from '../components/InputTypeTabs';\r\nimport { ModalLoader } from '../components/ModalLoader';\r\nimport { CenterContent } from '../components/styled/CenterContent';\r\nimport { SideBySide } from '../components/styled/SideBySide';\r\nimport { MODELS_URI } from '../const';\r\nimport { MediaElement } from '../MediaElement';\r\nimport { Root } from '../Root';\r\nimport { ReactElement } from '../types';\r\n\r\nconst AppBarContainer = styled(CenterContent)`\r\n  width: 100%;\r\n  margin-bottom: 20px;\r\n`\r\n\r\nconst ControlsContainer = styled.div`\r\n  width: 100%;\r\n`\r\n\r\nexport type BasePageProps = {\r\n  loadAdditionalModels: () => Promise<any>\r\n  processInputs: (state: BasePageState) => Promise<any>\r\n  renderControls: (state: BasePageState) => ReactElement\r\n  renderChildren?: (state: BasePageState) => ReactElement\r\n}\r\n\r\nexport type BasePageState = {\r\n  faceDetectionOptions: faceapi.FaceDetectionOptions\r\n  isFaceDetectorLoaded: boolean\r\n  areModelsLoaded: boolean\r\n  inputType: InputType\r\n  currentFps: number\r\n  mediaElement?: MediaElement\r\n  overlay?: HTMLCanvasElement\r\n}\r\n\r\nexport class BasePage extends React.Component<BasePageProps, BasePageState> {\r\n  state = {\r\n    faceDetectionOptions: new faceapi.SsdMobilenetv1Options(),\r\n    isFaceDetectorLoaded: false,\r\n    areModelsLoaded: false,\r\n    inputType: InputType.IMAGE,\r\n    currentFps: 0\r\n  }\r\n  processId: number\r\n  fpsMeter: number[] = []\r\n\r\n  async loadFaceDetector(detectorName: string) {\r\n    const faceDetector = getFaceDetectionNetFromName(detectorName)\r\n    faceDetector.isLoaded || faceDetector.loadFromUri(MODELS_URI)\r\n    this.setState({ isFaceDetectorLoaded: true })\r\n  }\r\n\r\n  async loadModels() {\r\n    await Promise.all([\r\n      this.loadFaceDetector(getFaceDetectorNameFromOptions(this.state.faceDetectionOptions)),\r\n      faceapi.nets.faceLandmark68Net.loadFromUri(MODELS_URI),\r\n      this.props.loadAdditionalModels()\r\n    ])\r\n    this.setState({ areModelsLoaded: true })\r\n  }\r\n\r\n  changeFaceDetector = async (faceDetectionOptions: faceapi.FaceDetectionOptions) => {\r\n    const detectorName = getFaceDetectorNameFromOptions(faceDetectionOptions)\r\n    const prevDetectorName = getFaceDetectorNameFromOptions(this.state.faceDetectionOptions)\r\n    if (detectorName !== prevDetectorName) {\r\n      await this.loadFaceDetector(detectorName)\r\n      //getFaceDetectionNetFromName(prevDetectorName).dispose()\r\n    }\r\n  }\r\n\r\n  onFaceDetectionOptionsChanged = async (faceDetectionOptions: faceapi.FaceDetectionOptions) => {\r\n    await this.changeFaceDetector(faceDetectionOptions)\r\n    this.setState({ faceDetectionOptions })\r\n  }\r\n\r\n  onInputTypeChanged = async (inputType: InputType) => {\r\n    this.setState({ inputType })\r\n    const faceDetectionOptions = inputType === InputType.IMAGE\r\n      ? new faceapi.SsdMobilenetv1Options()\r\n      : (\r\n        inputType === InputType.WEBCAM\r\n          ? new faceapi.TinyFaceDetectorOptions({ inputSize: 160 })\r\n          : new faceapi.TinyFaceDetectorOptions()\r\n      )\r\n\r\n    await this.changeFaceDetector(faceDetectionOptions)\r\n    this.setState({ faceDetectionOptions })\r\n  }\r\n\r\n  updateFpsMeter = (ts: number) => {\r\n    this.fpsMeter = [ts, ...this.fpsMeter].slice(0, 30)\r\n  }\r\n\r\n  getFps = () => {\r\n    const avgTimeInMs = this.fpsMeter.reduce((total, t) => total + t) / this.fpsMeter.length\r\n    return (1000 / avgTimeInMs) || null\r\n  }\r\n\r\n  processInputs = async () => {\r\n    const detector = getFaceDetectionNetFromName(getFaceDetectorNameFromOptions(this.state.faceDetectionOptions))\r\n    if (!detector.isLoaded) {\r\n      setTimeout(this.processInputs, 100)\r\n      return\r\n    }\r\n    await this.props.processInputs(this.state)\r\n  }\r\n\r\n  processFrames = async (processId: number) => {\r\n    const ts = Date.now()\r\n    await this.processInputs()\r\n    this.updateFpsMeter(Date.now() - ts)\r\n    if (this.processId !== null && this.processId === processId) {\r\n      setTimeout(this.processFrames.bind(this, processId), 0)\r\n    }\r\n  }\r\n\r\n  startProcessingFrames = () => {\r\n    this.processId = Date.now()\r\n    this.processFrames(this.processId)\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    if (this.state.inputType === InputType.IMAGE) {\r\n      this.processId = null\r\n      this.processInputs()\r\n      return\r\n    }\r\n\r\n    this.startProcessingFrames()\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.loadModels()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.processId = null\r\n  }\r\n\r\n  public render() {\r\n    if (!(typeof window !== 'undefined' && window.document)) {\r\n      return null\r\n    }\r\n\r\n    return(\r\n      <Root>\r\n        { !this.state.areModelsLoaded || !this.state.isFaceDetectorLoaded ? <ModalLoader title=\"Loading Models\" /> : null }\r\n        <AppBarContainer>\r\n          <div>\r\n            <InputTypeTabs\r\n              inputType={this.state.inputType}\r\n              onChange={this.onInputTypeChanged}\r\n            />\r\n          </div>\r\n        </AppBarContainer>\r\n        <ControlsContainer>\r\n          <SideBySide alignItems=\"baseline\">\r\n            <Mui.FormControl>\r\n              <FaceDetectorSelection\r\n                faceDetectionOptions={this.state.faceDetectionOptions}\r\n                onFaceDetectionOptionsChanged={this.onFaceDetectionOptionsChanged}\r\n              />\r\n            </Mui.FormControl>\r\n            { this.props.renderControls(this.state) }\r\n          </SideBySide>\r\n        </ControlsContainer>\r\n        { this.props.renderChildren ? this.props.renderChildren(this.state) : null }\r\n        <InputComponent\r\n          inputType={this.state.inputType}\r\n          onLoaded={refs => this.setState(refs)}\r\n          getFps={this.getFps}\r\n        />\r\n      </Root>\r\n    )\r\n  }\r\n}","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","import { SheetsRegistry } from 'jss';\r\nimport { createMuiTheme, createGenerateClassName } from '@material-ui/core/styles';\r\nimport { lightBlue } from '@material-ui/core/colors';\r\n\r\n// A theme with custom primary and secondary color.\r\n// It's optional.\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      ...lightBlue,\r\n      contrastText: 'white'\r\n    },\r\n  },\r\n  sideMenuWidth: '240px'\r\n});\r\n\r\nfunction createPageContext() {\r\n  return {\r\n    theme,\r\n    // This is needed in order to deduplicate the injection of CSS in the page.\r\n    sheetsManager: new Map(),\r\n    // This is needed in order to inject the critical CSS.\r\n    sheetsRegistry: new SheetsRegistry(),\r\n    // The standard class name generator.\r\n    generateClassName: createGenerateClassName(),\r\n  };\r\n}\r\n\r\nexport default function getPageContext() {\r\n  // Make sure to create a new context for every server-side request so that data\r\n  // isn't shared between connections (which would be bad).\r\n  if (!process.browser) {\r\n    return createPageContext();\r\n  }\r\n\r\n  // Reuse context on the client-side.\r\n  if (!global.__INIT_MATERIAL_UI__) {\r\n    global.__INIT_MATERIAL_UI__ = createPageContext();\r\n  }\r\n\r\n  return global.__INIT_MATERIAL_UI__;\r\n}"],"sourceRoot":""}